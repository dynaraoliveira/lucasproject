<p id="notice"><%= notice %></p>

<h1>Sensors</h1>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);
  function drawChart() {
    var data = google.visualization.arrayToDataTable([
      
      ['Hora', 'Potência1', 'Potência2', 'Potência3' ],

      [0,0,0,0],
      
      <% 
      @sensors.each do |sensor| 
            
      @cs0 = ((sensor.sensor0 * 220) / 1023) / 0.707
      @cs1 = ((sensor.sensor1 * 220) / 1023) / 0.707
      @cs2 = ((sensor.sensor2 * 220) / 1023) / 0.707
      
      @cs3 = ((sensor.sensor3 * 20) / 204.6) / 0.707
      @cs4 = ((sensor.sensor4 * 20) / 204.6) / 0.707
      @cs5 = ((sensor.sensor5 * 20) / 204.6) / 0.707
      
      @ts0 = @cs0 * @cs3
      @ts1 = @cs1 * @cs4
      @ts2 = @cs2 * @cs5
      
      @hora =  sensor.datainclusao.hour
      
      case @hora
      when 0..5
      @aaaa = [5,@ts0.to_i,@ts1.to_i,@ts2.to_i]
      when 6..10 
      @aaaa = [10,@ts0.to_i,@ts1.to_i,@ts2.to_i]
      when 7..15 
      @aaaa = [15,@ts0.to_i,@ts1.to_i,@ts2.to_i]
      when 16..20 
      @aaaa = [20,@ts0.to_i,@ts1.to_i,@ts2.to_i]
      end
      %>
      
      <%= @aaaa %>,
      
      <% end %>      
      
      [21,0,0,0]
      
    ]);

    var options = {
      title: 'Potência',
      hAxis: {title: 'Horas',  titleTextStyle: {color: '#333'}},
      vAxis: {minValue: 0}
    };

    var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script>

<div id="chart_div" style="width: 900px; height: 500px;"></div>


<% @sensors.each do |sensor| 
      
@cs0 = ((sensor.sensor0 * 220) / 1023) / 0.707
@cs1 = ((sensor.sensor1 * 220) / 1023) / 0.707
@cs2 = ((sensor.sensor2 * 220) / 1023) / 0.707

@cs3 = ((sensor.sensor3 * 20) / 204.6) / 0.707
@cs4 = ((sensor.sensor4 * 20) / 204.6) / 0.707
@cs5 = ((sensor.sensor5 * 20) / 204.6) / 0.707

@ts0 = @cs0 * @cs3
@ts1 = @cs1 * @cs4
@ts2 = @cs2 * @cs5

@hora =  sensor.datainclusao.hour

@aaaa = [@hora,@ts0.to_i,@ts1.to_i,@ts2.to_i]

%>

<%= @aaaa %>

<% end %>

<table>
  <thead>
    <tr>
      <th>Chave</th>
      <th>Sensor0</th>
      <th>Sensor1</th>
      <th>Sensor2</th>
      <th>Sensor3</th>
      <th>Sensor4</th>
      <th>Sensor5</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @sensors.each do |sensor| %>
      <tr>
        <td><%= sensor.chave %></td>
        <td><%= sensor.sensor0 %></td>
        <td><%= sensor.sensor1 %></td>
        <td><%= sensor.sensor2 %></td>
        <td><%= sensor.sensor3 %></td>
        <td><%= sensor.sensor4 %></td>
        <td><%= sensor.sensor5 %></td>
        <td><%= link_to 'Show', sensor %></td>
        <td><%= link_to 'Edit', edit_sensor_path(sensor) %></td>
        <td><%= link_to 'Destroy', sensor, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Sensor', new_sensor_path %>
